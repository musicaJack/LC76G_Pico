# 按键控制功能说明

## 功能概述
GPIO-14 按键控制功能已成功集成到GPS仪表盘项目中。

## 按键功能
- **短按** (< 1秒)：控制ILI9488屏幕开/关
- **长按** (≥ 1秒)：切换搜星界面/仪表盘界面

## 硬件连接
- 按键连接到 **GPIO-14**
- 按键另一端连接到 **GND**
- 使用内部上拉电阻，按键按下时为低电平

## 技术实现

### 按键检测算法
- **防抖处理**：50ms防抖时间
- **时间检测**：精确测量按键按下时长
- **状态管理**：避免重复触发

### 屏幕控制
- **背光控制**：通过GPIO-16控制背光开关
- **显示更新**：屏幕关闭时停止显示更新，节省资源

### UI切换
- **双向切换**：GPS信息界面 ↔ 仪表盘界面
- **状态保持**：切换时保持GPS数据状态
- **界面重置**：切换时重新初始化界面元素

## 使用说明

### 短按操作
1. 按下按键并快速释放（< 1秒）
2. 屏幕会在开启/关闭状态间切换
3. 控制台会显示相应状态信息

### 长按操作
1. 按下按键并保持1秒以上
2. 释放按键
3. 界面会在GPS信息显示和仪表盘间切换
4. 控制台会显示切换信息

## 调试信息
程序运行时会输出详细的按键操作日志：
```
[按键] 按键按下
[按键] 短按检测 (时长: 150 ms) - 切换屏幕
[按键] 屏幕开启
[按键] 长按检测 (时长: 1200 ms) - 切换UI
[按键] 切换到仪表盘界面
```

## 配置参数
在 `include/pin_config.hpp` 中可以调整以下参数：
- `BUTTON_PIN`：按键引脚（默认GPIO-14）
- `BUTTON_SHORT_PRESS_MS`：短按时间阈值（默认1000ms）
- `BUTTON_LONG_PRESS_MS`：长按时间阈值（默认1000ms）
- `BUTTON_DEBOUNCE_MS`：防抖时间（默认50ms）

## 注意事项
1. 按键需要连接到GND，使用内部上拉电阻
2. 长按和短按的时间阈值相同（1秒），可根据需要调整
3. 屏幕关闭时仍会继续GPS数据处理，只是不更新显示
4. 按键操作会实时输出到控制台，便于调试
